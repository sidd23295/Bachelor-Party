<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bachelor Party ‚Äì Access Gate</title>
  <style>
    :root{
      --bg:#07070a;
      --card: rgba(15,15,20,0.70);
      --border: rgba(255,255,255,0.10);
      --text:#f4f4f4;
      --muted:#bdbdbd;
      --neon1:#00f5ff;
      --neon2:#ff3df0;
      --neon3:#ffe66d;
      --good:#67ff7a;
      --bad:#ff5a5a;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      min-height:100vh;
      color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1000px 650px at 10% 0%, rgba(0,245,255,0.18), transparent 60%),
        radial-gradient(1000px 650px at 90% 10%, rgba(255,61,240,0.16), transparent 60%),
        radial-gradient(900px 600px at 50% 110%, rgba(255,230,109,0.10), transparent 55%),
        linear-gradient(180deg, #06060a, #0a0a10);
      overflow:hidden;
    }
    .orb{
      position:absolute; width:280px; height:280px; border-radius:50%;
      filter:blur(50px); opacity:.35; mix-blend-mode:screen;
      animation: drift 14s ease-in-out infinite;
    }
    .orb.o1{background:var(--neon1); top:-90px; left:-70px;}
    .orb.o2{background:var(--neon2); top:10%; right:-100px; animation-delay:-4s;}
    .orb.o3{background:var(--neon3); bottom:-120px; left:20%; animation-delay:-7s;}
    @keyframes drift{
      0%{transform:translate(0,0) scale(1);}
      50%{transform:translate(40px,30px) scale(1.15);}
      100%{transform:translate(0,0) scale(1);}
    }

    .wrap{
      position:relative;
      z-index:2;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:24px;
    }

    .card{
      width:min(980px, 94vw);
      border-radius:22px;
      background:var(--card);
      border:1px solid var(--border);
      box-shadow:0 20px 60px rgba(0,0,0,0.65);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:18px 20px;
      border-bottom:1px solid rgba(255,255,255,0.08);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      font-weight:800;
      letter-spacing:.02em;
    }
    .pill{
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--muted);
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.04);
    }
    .btn{
      appearance:none;
      border:none;
      color:var(--text);
      background:rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.14);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:600;
      transition:transform .06s ease, background .15s ease;
    }
    .btn:hover{background:rgba(255,255,255,0.12);}
    .btn:active{transform:scale(0.98);}
    .btn.primary{
      border-color: rgba(0,245,255,0.45);
      box-shadow: 0 0 0 3px rgba(0,245,255,0.10);
    }

    .content{
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:16px;
      padding:16px;
    }
    @media (max-width: 980px){
      .content{grid-template-columns: 1fr; }
    }

    .panel{
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.10);
      background:rgba(0,0,0,0.18);
      overflow:hidden;
    }
    .panelHeader{
      padding:14px 14px 12px;
      border-bottom:1px solid rgba(255,255,255,0.08);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .panelHeader h2{
      margin:0;
      font-size:14px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--muted);
      font-weight:800;
    }

    /* Loading screen */
    .loadingStage{
      height: 420px;
      display:grid;
      place-items:center;
      padding:22px;
      position:relative;
    }
    .loadingBox{
      text-align:center;
      max-width:56ch;
    }
    .title{
      margin:10px 0 8px;
      font-size: clamp(26px, 3.5vw, 40px);
      font-weight:900;
      text-shadow: 0 0 14px rgba(0,245,255,0.18), 0 0 28px rgba(255,61,240,0.12);
    }
    .sub{
      margin:0 0 16px;
      color:#d6d6d6;
      line-height:1.55;
    }
    .sweep{
      position:relative;
      height:3px;
      width:min(520px,86%);
      margin:16px auto 12px;
      border-radius:999px;
      background:rgba(255,255,255,0.10);
      overflow:hidden;
    }
    .sweep::after{
      content:"";
      position:absolute;
      inset:-2px 0;
      width:45%;
      background:linear-gradient(90deg, transparent, var(--neon1), var(--neon2), transparent);
      filter:blur(2px);
      animation:sweep 1.35s linear infinite;
    }
    @keyframes sweep{ 0%{transform:translateX(-120%);} 100%{transform:translateX(240%);} }
    .dots{display:flex; justify-content:center; gap:10px; margin:10px 0 18px;}
    .dot{width:10px;height:10px;border-radius:50%; background:var(--neon1); opacity:.8; animation:bounce 1s infinite ease-in-out; box-shadow:0 0 12px rgba(0,245,255,0.85);}
    .dot:nth-child(2){background:var(--neon2); animation-delay:.15s; box-shadow:0 0 12px rgba(255,61,240,0.85);}
    .dot:nth-child(3){background:var(--neon3); animation-delay:.30s; box-shadow:0 0 12px rgba(255,230,109,0.85);}
    @keyframes bounce{0%,80%,100%{transform:translateY(0);opacity:.55;} 40%{transform:translateY(-10px);opacity:1;}}

    /* Game area */
    .arena{
      height: 420px;
      position:relative;
      user-select:none;
      touch-action: manipulation;
      background:
        radial-gradient(900px 500px at 50% 20%, rgba(255,255,255,0.06), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.15));
    }
    .arena::after{
      content:"";
      position:absolute;
      inset:0;
      background-image:
        linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
      background-size: 48px 48px;
      opacity:.35;
      pointer-events:none;
      mask-image: radial-gradient(circle at center, rgba(0,0,0,1), rgba(0,0,0,0));
    }

    .hud{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      padding:12px 14px;
      border-bottom:1px solid rgba(255,255,255,0.08);
      background:rgba(0,0,0,0.20);
      position:relative;
      z-index:3;
    }
    .stat{
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.04);
      font-size:13px;
      color:#e9e9e9;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .stat b{font-weight:900;}
    .hint{color:var(--muted); font-size:12px; margin-left:auto;}

    .target{
      position:absolute;
      width:64px; height:64px;
      border-radius:50%;
      cursor:pointer;
      transform: translate(-50%, -50%);
      background:
        radial-gradient(circle at center, rgba(0,0,0,0) 38%, rgba(0,0,0,0.0) 39%),
        radial-gradient(circle at center, rgba(0,245,255,0.20), rgba(255,61,240,0.12));
      border:2px solid rgba(0,245,255,0.55);
      box-shadow:
        0 0 0 6px rgba(0,245,255,0.10),
        0 0 30px rgba(0,245,255,0.22),
        0 0 30px rgba(255,61,240,0.12);
      animation: pop .12s ease-out;
    }
    .target::before, .target::after{
      content:"";
      position:absolute;
      inset:10px;
      border-radius:50%;
      border:2px solid rgba(255,255,255,0.18);
    }
    .target::after{
      inset:22px;
      border-color: rgba(255,61,240,0.30);
    }
    @keyframes pop{ from{transform:translate(-50%,-50%) scale(.9); opacity:.6;} to{transform:translate(-50%,-50%) scale(1); opacity:1;}}

    .crosshair{
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index:2;
    }
    .crosshair .v, .crosshair .h{
      position:absolute;
      background:rgba(255,255,255,0.08);
    }
    .crosshair .v{width:1px; top:0; bottom:0; left:50%;}
    .crosshair .h{height:1px; left:0; right:0; top:50%;}
    .toast{
      position:absolute;
      left:50%;
      bottom:16px;
      transform:translateX(-50%);
      padding:10px 12px;
      border-radius:12px;
      font-weight:700;
      border:1px solid rgba(255,255,255,0.16);
      background:rgba(0,0,0,0.35);
      color:#f1f1f1;
      display:none;
      z-index:5;
      max-width: min(92%, 520px);
      text-align:center;
    }
    .toast.show{display:block; animation: toastIn .22s ease-out;}
    @keyframes toastIn{from{opacity:0; transform:translateX(-50%) translateY(6px);} to{opacity:1; transform:translateX(-50%) translateY(0);} }

    /* Right side panel */
    .side{
      padding:14px;
    }
    .side h3{
      margin:0 0 10px;
      font-size:18px;
      font-weight:900;
    }
    .side p{
      margin:0 0 12px;
      color:#d2d2d2;
      line-height:1.55;
    }
    .rules{
      margin:12px 0 14px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background:rgba(255,255,255,0.04);
      color:#ddd;
      font-size:14px;
    }
    .rules ul{margin:8px 0 0; padding-left:18px;}
    .rules li{margin:6px 0;}

    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
      margin-top:10px;
    }

    /* Overlay for unlock */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      background:rgba(0,0,0,0.55);
      z-index:10;
      padding:18px;
    }
    .overlay.show{display:grid;}
    .modal{
      width:min(560px, 92vw);
      border-radius:20px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(10,10,14,0.85);
      box-shadow:0 30px 80px rgba(0,0,0,0.7);
      padding:18px;
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .modal h3{margin:8px 0 6px; font-size:24px; font-weight:950;}
    .modal p{margin:0 0 12px; color:#d7d7d7; line-height:1.5;}
    .big{
      font-size:46px;
      margin:6px 0 10px;
      animation: pulse 1.3s ease-in-out infinite;
      filter: drop-shadow(0 0 16px rgba(0,245,255,0.25));
    }
    @keyframes pulse{0%,100%{transform:scale(1);} 50%{transform:scale(1.06);} }

    .confetti{
      position:absolute; inset:0; pointer-events:none; opacity:.9;
    }
    .confetti i{
      position:absolute; top:-10vh;
      width:8px; height:14px; border-radius:2px;
      animation: fall linear infinite;
    }
    .confetti i:nth-child(1){left:10%; background:var(--neon1); animation-duration:7s;}
    .confetti i:nth-child(2){left:22%; background:var(--neon2); animation-duration:9s; animation-delay:-2s;}
    .confetti i:nth-child(3){left:34%; background:var(--neon3); animation-duration:8s; animation-delay:-4s;}
    .confetti i:nth-child(4){left:48%; background:#7cff6b; animation-duration:10s; animation-delay:-6s;}
    .confetti i:nth-child(5){left:62%; background:#ff7b54; animation-duration:7.5s; animation-delay:-3s;}
    .confetti i:nth-child(6){left:76%; background:#9b7bff; animation-duration:9.5s; animation-delay:-5s;}
    .confetti i:nth-child(7){left:88%; background:#ffd166; animation-duration:8.5s; animation-delay:-1s;}
    @keyframes fall{
      0%{transform:translateY(-10vh) rotate(0deg); opacity:.9;}
      100%{transform:translateY(110vh) rotate(520deg); opacity:.9;}
    }
  </style>
</head>
<body>
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="orb o3"></div>

  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div class="brand">üéâ Bachelor Party HQ <span class="pill">Access Gate</span></div>
        <div style="display:flex; gap:10px; align-items:center;">
          <button class="btn" id="resetBtn" title="Resets unlock + score">Reset</button>
          <button class="btn primary" id="skipIfUnlockedBtn" title="If already unlocked, go to HQ">Go to HQ</button>
        </div>
      </div>

      <div class="content">
        <!-- Left: stage -->
        <div class="panel">
          <div class="panelHeader">
            <h2 id="stageTitle">Initializing</h2>
            <span class="pill" id="stagePill">Loading</span>
          </div>

          <!-- Loading -->
          <div class="loadingStage" id="loadingStage">
            <div class="loadingBox">
              <div class="title">Booting the Weekend Plan</div>
              <p class="sub">
                Prove you‚Äôve got the hands. Hit <b>10 markers in a row</b> to unlock the HQ.
              </p>
              <div class="sweep"></div>
              <div class="dots" aria-hidden="true">
                <div class="dot"></div><div class="dot"></div><div class="dot"></div>
              </div>
              <button class="btn primary" id="startBtn">Start Challenge</button>
              <div class="small">Tip: Tap/click the glowing marker. Miss = streak resets.</div>
            </div>
          </div>

          <!-- Game -->
          <div class="arena" id="arena" style="display:none;">
            <div class="hud">
              <div class="stat">üéØ Streak: <b id="streak">0</b> / 10</div>
              <div class="stat">‚úÖ Hits: <b id="hits">0</b></div>
              <div class="stat">‚ùå Misses: <b id="misses">0</b></div>
              <div class="hint">Hit the marker before it times out.</div>
            </div>
            <div class="crosshair" aria-hidden="true"><div class="v"></div><div class="h"></div></div>
            <div class="toast" id="toast"></div>
          </div>
        </div>

        <!-- Right: instructions -->
        <div class="panel side">
          <h3>How it works</h3>
          <p>
            This is a fun ‚Äúdoor‚Äù into the real bachelor party page.
            Score <b>10 hits in a row</b> to unlock.
          </p>
          <div class="rules">
            <b>Rules</b>
            <ul>
              <li>One marker at a time.</li>
              <li>Miss (or timeout) resets streak to 0.</li>
              <li>When unlocked, you‚Äôll be redirected to <code>party.html</code>.</li>
            </ul>
          </div>
          <p class="small">
            Note: This is not real security ‚Äî it‚Äôs just a vibe gate. Anyone can still visit <code>party.html</code>
            directly if they type it in.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Unlock overlay -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <div class="confetti" aria-hidden="true">
        <i></i><i></i><i></i><i></i><i></i><i></i><i></i>
      </div>
      <div class="big">üîì</div>
      <h3>Access Granted</h3>
      <p>Welcome to HQ. Redirecting‚Ä¶</p>
      <button class="btn primary" id="goBtn">Go Now</button>
    </div>
  </div>

  <script>
    // --- Config ---
    const REQUIRED_STREAK = 10;
    const TARGET_TIMEOUT_MS = 1200; // medium difficulty; increase to make easier
    const TARGET_SIZE_PX = 62;      // adjust size here

    // --- Elements ---
    const loadingStage = document.getElementById('loadingStage');
    const arena = document.getElementById('arena');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const goBtn = document.getElementById('goBtn');
    const skipBtn = document.getElementById('skipIfUnlockedBtn');

    const stageTitle = document.getElementById('stageTitle');
    const stagePill = document.getElementById('stagePill');

    const streakEl = document.getElementById('streak');
    const hitsEl = document.getElementById('hits');
    const missesEl = document.getElementById('misses');
    const toast = document.getElementById('toast');

    const overlay = document.getElementById('overlay');

    // --- State ---
    let streak = 0;
    let hits = 0;
    let misses = 0;
    let playing = false;

    let targetEl = null;
    let targetTimer = null;
    let targetActive = false;

    const UNLOCK_KEY = "bp_unlocked_v1";

    function showToast(msg, good=true){
      toast.textContent = msg;
      toast.style.borderColor = good ? "rgba(103,255,122,0.35)" : "rgba(255,90,90,0.35)";
      toast.style.boxShadow = good ? "0 0 0 3px rgba(103,255,122,0.10)" : "0 0 0 3px rgba(255,90,90,0.10)";
      toast.classList.add('show');
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=> toast.classList.remove('show'), 900);
    }

    function updateHUD(){
      streakEl.textContent = String(streak);
      hitsEl.textContent = String(hits);
      missesEl.textContent = String(misses);
    }

    function setStage(mode){
      if(mode === "loading"){
        stageTitle.textContent = "Initializing";
        stagePill.textContent = "Loading";
        loadingStage.style.display = "grid";
        arena.style.display = "none";
      } else {
        stageTitle.textContent = "Aim Trainer";
        stagePill.textContent = "Live";
        loadingStage.style.display = "none";
        arena.style.display = "block";
      }
    }

    function clearTarget(){
      if(targetTimer) clearTimeout(targetTimer);
      targetTimer = null;
      targetActive = false;
      if(targetEl){
        targetEl.remove();
        targetEl = null;
      }
    }

    function fail(reason){
      misses += 1;
      streak = 0;
      updateHUD();
      showToast(reason + " ‚Äî streak reset.", false);
    }

    function spawnTarget(){
      clearTarget();

      const hudHeight = 52; // approx; keep targets below HUD
      const rect = arena.getBoundingClientRect();

      const minX = 40;
      const maxX = rect.width - 40;
      const minY = hudHeight + 60;
      const maxY = rect.height - 50;

      const x = Math.random() * (maxX - minX) + minX;
      const y = Math.random() * (maxY - minY) + minY;

      targetEl = document.createElement('div');
      targetEl.className = 'target';
      targetEl.style.width = TARGET_SIZE_PX + "px";
      targetEl.style.height = TARGET_SIZE_PX + "px";
      targetEl.style.left = x + "px";
      targetEl.style.top = y + "px";

      targetEl.addEventListener('click', (e) => {
        e.stopPropagation();
        if(!playing || !targetActive) return;

        targetActive = false;
        hits += 1;
        streak += 1;
        updateHUD();
        showToast("Hit! +" + 1, true);

        if(streak >= REQUIRED_STREAK){
          unlock();
          return;
        }
        // next target quickly
        setTimeout(spawnTarget, 140);
      });

      arena.appendChild(targetEl);
      targetActive = true;

      targetTimer = setTimeout(() => {
        if(!playing) return;
        clearTarget();
        fail("Too slow");
        setTimeout(spawnTarget, 200);
      }, TARGET_TIMEOUT_MS);
    }

    function unlock(){
      playing = false;
      clearTarget();
      localStorage.setItem(UNLOCK_KEY, "true");
      overlay.classList.add('show');
      // auto redirect
      setTimeout(()=> window.location.href = "./party.html", 900);
    }

    function startGame(){
      playing = true;
      streak = 0; hits = 0; misses = 0;
      updateHUD();
      setStage("game");
      showToast("Go. 10 in a row.", true);

      // Important: miss-click anywhere in arena counts as a miss
      arena.onclick = () => {
        if(!playing) return;
        if(targetActive){
          clearTarget();
          fail("Miss");
          setTimeout(spawnTarget, 200);
        }
      };

      spawnTarget();
    }

    function resetAll(){
      localStorage.removeItem(UNLOCK_KEY);
      playing = false;
      clearTarget();
      overlay.classList.remove('show');
      streak = 0; hits = 0; misses = 0;
      updateHUD();
      setStage("loading");
      showToast("Reset complete.", true);
    }

    // --- Wire up ---
    startBtn.addEventListener('click', startGame);
    goBtn.addEventListener('click', () => window.location.href = "./party.html");
    resetBtn.addEventListener('click', resetAll);

    skipBtn.addEventListener('click', () => {
      if(localStorage.getItem(UNLOCK_KEY) === "true"){
        window.location.href = "./party.html";
      } else {
        showToast("Not unlocked yet. Beat the challenge.", false);
      }
    });

    // If already unlocked, offer quick redirect
    if(localStorage.getItem(UNLOCK_KEY) === "true"){
      stageTitle.textContent = "Welcome back";
      stagePill.textContent = "Unlocked";
      // small nudge
      setTimeout(() => {
        showToast("Already unlocked. Tap ‚ÄúGo to HQ‚Äù.", true);
      }, 500);
    } else {
      setStage("loading");
    }
  </script>
</body>
</html>
